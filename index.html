<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Task Log</title>
<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 800px;
    margin: auto;
    padding: 1rem;
    background: #f8f9fa;
  }
  h1 { text-align: center; }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1rem;
  }
  th, td {
    border: 1px solid #ddd;
    padding: 8px;
  }
  th {
    background-color: #007BFF;
    color: white;
  }
  tr:nth-child(even) {
    background-color: #f2f2f2;
  }
</style>
</head>
<body>

<h1>Task Log</h1>
<table id="taskTable">
  <thead>
    <tr>
      <th>Date</th>
      <th>Time Range</th>
      <th>Task</th>
      <th>Productivity</th>
    </tr>
  </thead>
  <tbody>
    <tr><td colspan="4" style="text-align:center;">Loading...</td></tr>
  </tbody>
</table>

<script>
// ===== CONFIG =====
const GITHUB_RAW_URL = "https://raw.githubusercontent.com/USERNAME/REPO/main/log.txt"; // Change this

// ===== FETCH & DISPLAY =====
async function loadLogs() {
    try {
        const response = await fetch(GITHUB_RAW_URL + "?t=" + Date.now()); // prevent cache
        const text = await response.text();

        const rows = text.trim().split("\n").map(line => {
            const [startDate, startTime, task, endDate, endTime, rating] = line.split(/\t/);
            const date = startDate.trim();
            const timeRange = `${startTime.trim()} to ${endTime.trim()}`;
            const productivity = rating ? rating.trim() : "";
            return { date, timeRange, task: task.trim(), productivity };
        });

        renderTable(rows);
    } catch (err) {
        console.error("Error loading logs:", err);
        document.querySelector("#taskTable tbody").innerHTML =
            `<tr><td colspan="4" style="text-align:center;color:red;">Failed to load logs</td></tr>`;
    }
}

function renderTable(rows) {
    const tbody = document.querySelector("#taskTable tbody");
    tbody.innerHTML = rows.map(r =>
        `<tr>
            <td>${r.date}</td>
            <td>${r.timeRange}</td>
            <td>${r.task}</td>
            <td>${r.productivity}</td>
        </tr>`
    ).join("");
}

// ===== SERVICE WORKER REGISTER =====
if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("sw.js").then(reg => {
        console.log("Service Worker registered", reg);
    });
}

// Load on page open
loadLogs();
</script>

</body>
</html>
